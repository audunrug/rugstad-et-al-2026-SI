---
title: "Supporting Information 1: R package usage"
format: pdf
editor: visual
fig-format: png
date: today
crossref: 
  fig-title: "Supplementary Figure 1."
  fig-prefix: "Sup. Figure 1."
  tbl-title: "Supplementary Table 1."
  tbl-prefix: "Sup. Table 1."
  chapters: true
bibliography: references.bib
---

This vignette contains the code and figures for comparing the relative usage of the `R` packages `gllvm` [@gllvm_off], `hmsc` [@hmsc_off], `boral` [@boral_off], `ecoCopula` [@ecoCopula_off], `glmmTMB` [@glmmTMB_off] and `VGAM` [@VGAM_off], which are all used for latent variable modelling, with the `vegan` package [@vegan_off], a go-to for classical ordination, based on monthly downloads of each package from the Comprehensive R Archive Network (CRAN).

Note that `glmmTMB` and `VGAM` are packages that are also heavily used for general-purpose GLMM- and GAM modeling in addition to GLLVMs. As such, the numbers for these packages likely are not really very informative with regards to their use for latent variable modelling among ecologists, compared to the other packages.

### Data setup

```{r}
#| output: false
# load required R packages
library(cranlogs) # get package download data from cran
library(dplyr) # data handling
library(lubridate) # aggregate data by date
library(ggplot2) # plotting
```

We begin by loading the data, from the beginning of 2020 to the end of 2025.

```{r}
#| output: false
#| warning: false
data_downloads <- cran_downloads(packages=c("vegan","gllvm","Hmsc","boral",
                                            "ecoCopula","glmmTMB","VGAM"),
                                 from = "2020-01-01", to = "2025-12-31")
downloads_monthly <- data_downloads |> 
  group_by(month=floor_date(date, "month"),package) |> 
  summarise(count=sum(count))
```

We also calculate the monthly ratio of downloads for each package:

```{r}
downloads_monthly <- downloads_monthly |> mutate(ratio=count/sum(count))
```

## Plotting

We then plot the data in a graph:

```{r}
#| echo: true
#| warning: false
#| label: fig-cit
#| fig-cap: "yearly citations for the vegan R package (classical ordination tools) and R packages in which model-based ordination tools are central (boral, gllvm and hmsc)."
#| fig-subcap: 
#| - "Total number of monthly citations for each package"
#| - "Percentage of total citations across all packages per month"
#| fig-width: 9
#| fig-height: 4
ggplot(downloads_monthly) + # total downloads/month
  geom_histogram(aes(x=month, y=count, fill=package),stat="identity") +
  theme_classic() +
  labs(color="Package", y="Total monthly downloads", x="Date", 
       title="Monthly CRAN downloads (2020-2025)") +
  scale_fill_brewer(palette="Set2") +
  scale_x_date(date_breaks = "1 year")
ggplot(downloads_monthly) +  # relative downloads/month
  geom_histogram(aes(x=month, y=ratio, fill=package),stat="identity") +
  labs(color="Package", y="Relative monthly downloads", x="Date", 
       title="Relative number of monthly CRAN downloads (2020-2025)") +
  scale_fill_brewer(palette="Set2") +
  theme_classic() +
  scale_x_date(date_breaks = "1 year")
```

\newpage

# References
